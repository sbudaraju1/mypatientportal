<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Patient Portal - Signup</title>
  <link rel="stylesheet" href="/css/styles.css">
  <style>
	body {
  		background-image: url('/blue_background.jpg');
		background-size: cover;
		background-position: center;
	}
  </style>
</head>
<body>
  <div class="container">
    <h2>Create a Patient Account</h2>
    <form id="signupForm">
      <label>Username</label>
      <input type="text" name="username" required>
      <label>Password</label>
      <input type="password" name="password" required>
      <label>Full name</label>
      <input type="text" name="name">
      <label>Birthday</label>
      <input type="date" name="birthday" placeholder="2000-01-31">
      <button type="submit">Sign Up</button>
      <p id="err" class="err"></p>
    </form>
    <a href="login_page.html">Back to Login</a><br>
  </div>
<script>
document.getElementById("signupForm").addEventListener("submit", async (e) => {
  e.preventDefault();
  
  const f = e.target;
  const payload = {
    username: f.username.value.trim(),
    password: f.password.value,
    name: f.name.value.trim(),
    birthday: f.birthday.value.trim()
  };
  
  try {
    const res = await fetch("/signup", {
      method: "POST",
      headers: {"Content-Type":"application/json"},
      body: JSON.stringify(payload)
    });
    
    const data = await res.json();
    
    if (data.ok) {
      alert("Signup complete. Please log in.");
      window.location = "/login_page.html";
    } else {
      document.getElementById("err").textContent = data.error || "Error creating account";
    }
  } catch (error) {
    document.getElementById("err").textContent = "Network error. Please try again.";
  }
});
</script>
</body>

</html>

